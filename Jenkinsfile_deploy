pipeline {
    agent any
    stages{
        stage("deploy"){
            steps{
                script {
                    println "here we are doing deploy"
                    sh '''
                    #!/bin/bash

                    inputservers=$@



                    IFS="," read -r -a servers <<< $inputservers


                    for serverip in ${servers[@]}
                    do
                            aws s3 cp s3:sedply101/origin/$BRANCH_NAME/$BUILD_NUMBER/hello-$BUILD_NUMBER.war .
                            scp -i /tmp/kiran.pem hello-${BUILD_NUMBER}.war ec2-user@$serverip:/var/lib/tomcat/webapps

                    done
       
                    '''
                }
            }
        }
    }
}